```{r chapter-2-setup, echo = FALSE, message = FALSE, warning = FALSE}
library(PerformanceAnalytics)
library(data.table)
library(tidyverse)
library(hrbrthemes)
library(ggcorrplot)
library(GoodmanKruskal)
library(lindia)
library(finalfit)
library(sigr)
library(papaja)
library(here)
library(kableExtra)
```

# Week 2 â€“ Regression and model validation

```{r load-data, echo = FALSE, message= FALSE}

learning2014 <- fread(here("data/learning2014.csv"))

```



Show a graphical overview of the data and show summaries of the variables in the data. Describe and interpret the outputs, commenting on the distributions of the variables and the relationships between them. (0-3 points)

```{r graphical-overview-continous, echo = FALSE}

chart.Correlation(learning2014[,-1], histogram=TRUE, pch=19, method="pearson")

```

```{r graphical-overview-gender, echo = FALSE}
ggplot(learning2014, aes(factor(gender),attitude)) + 
  geom_violin() + 
  theme_ipsum()
```

```{r graphical-overview-gender-age, echo = FALSE}
ggplot(learning2014, aes(factor(gender),age)) + 
  geom_violin() + 
  theme_ipsum()
```


```{r graphical-overview-relationship, echo = FALSE}
ggplot(learning2014, aes(color = gender, x = attitude, y = points, size = stra)) + 
  geom_point() + 
  geom_smooth(method = "lm", fill = NA) +
  scale_size_continuous(range = c(0.05,2)) +
  theme_bw()
```




Surface approach: memorizing without understanding, with a serious lack of personal engagement in the learning process. Intention of getting forward with minimium trouble

Deep approach: intention to maximize understanding with ta true commitment to learning. Strong need to engage in the actual content of the task.
STrategic approad: the ways students organize their studying.

ASSIST: the appproaches and study skills inventory for studets -survey (Tait, Etwishle, MacCune, 1008). Items were measured with a five point Likert skale (1=disagree, 5=agree)

Learning approach, 8 subscales, 4 items each.

1. Deep: seeking meaning, relating ideas, use of evidence
2. surface: lack of purpose, unrelated memorizing, syllabus-boundness
3. stratcgic: organized studying, time management

students achievement was measured by points in the exaams

n=183, (67% female, mean age of 25,6 years, SD=7.7)
age skewed (median 22)

Vehkalahti , K 2016 , The relationship between learning approaches and students' achievements in an introductory statistics course in Finland . in Proceedings of the 60th ISI World Statistics Congress of the International Statistical Institute, ISI2015 . INTERNATIONAL STATISTICAL INSTITUTE , pp. 68-73 , ISI World Statistics Congress , Rio de Janeiro , Brazil , 26/07/2015 .
Based on http://hdl.handle.net/10138/163015


In building linear regression models, it is desirable to have high correlations between the prediction covariates and the response variable, but small correlations between the different prediction covariates. Large correlations between prediction variables leads to the problem of collinearity in linear regression. Therefore, based on explorative analysis in fig 1, two non-correlating variables where chosen an prediction covariates

```{r fit-attitude_stra_surf}
# Choose three variables as explanatory variables and 
# fit a regression model where exam points is the target (dependent) variable.

model_attitude_stra_surf <- lm(
  data = learning2014, 
  formula = points ~ attitude + stra + surf )

```
```{r model_attitude_stra_surf_summary, echo = FALSE}

# Show a summary of the fitted model and comment and interpret the results. 
# Explain and interpret the statistical test related to the model parameters.

model_attitude_stra_surf_summary <- apa_print(model_attitude_stra_surf)
knitr::kable(
  model_attitude_stra_surf_summary$table,
  format="html") %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"))
```



`r render(wrapFTest(model_attitude_stra_surf, pSmallCutoff=0, format="markdown"))`. Adjusted <i>R^2^</i> is `r round(summary(model_attitude_stra_surf)$adj.r.squared, 2)`.

```{r fit-attitude_stra}
# If an explanatory variable in your model does not have 
# a statistically significant relationship with the target variable
# remove the variable from the model and fit the model again without it.

model_attitude_stra <- lm(
  data = learning2014, 
  formula = points ~ attitude + stra)

```

```{r model_model_attitude_stra_summary, echo = FALSE}


model_attitude_stra_summary <- apa_print(model_attitude_stra)
knitr::kable(
  model_attitude_stra_summary$table,
  format="html") %>% 
  kable_styling(bootstrap_options = c("striped", "condensed"))
```


For the modified, final model `r render(wrapFTest(model_attitude_stra, pSmallCutoff=0, format="markdown"))`. Adjusted <i>R^2^</i> is `r round(summary(model_attitude_stra)$adj.r.squared, 2)`.



```{r instructions, echo = FALSE, eval = FALSE}
# Produce the following diagnostic plots: 
# Residuals vs Fitted values
# Normal QQ-plot
# Residuals vs Leverage. 
# Explain the assumptions of the model and interpret the validity of 
# those assumptions based on the diagnostic plots. (0-3 points)
```




```{r residuals-fitted, echo = FALSE}
gg_resfitted(model_attitude_stra, scale.factor = 1) + theme_bw()
```


```{r qqplot, echo = FALSE}
gg_qqplot(model_attitude_stra, scale.factor = 1) + theme_bw()
```

```{r residual-leverage, echo = FALSE}
gg_resleverage(model_attitude_stra, method = "loess", se = FALSE, scale.factor = 1) + theme_bw()
```







After completing all the phases above you are ready to submit your exercise for the peer-review (the workshop): click on the link ("RStudio Exercise") above these instructions. Have the two links (your GitHub repository and your course diary) ready!
